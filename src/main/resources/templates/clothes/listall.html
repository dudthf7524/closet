<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/nav.css">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script
            src="https://kit.fontawesome.com/577d3f36ff.js"
            crossorigin="anonymous">
    </script>
    <style>
        /* ìŠ¤íƒ€ì¼ ì •ì˜ */
        .form-wrapper {
            display: flex;
            align-items: end; /* ì„¸ë¡œ ì •ë ¬ */
            justify-content: center;
            gap: 30px; /* ì´ë¯¸ì§€ì™€ ì…ë ¥ í¼ ê°„ê²© */
            padding: 20px;
        }
         .list {
            overflow-y: auto; /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ë°” */
            overflow-x: auto; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ë°” ì¶”ê°€ */
            width: 100%;
            height: 500px;
            max-width: 1000px; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ë°”ê°€ ë‚˜íƒ€ë‚  ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
            padding: 10px;
            border: 1px solid #ddd; /* ì™¸ê³½ì„  ì¶”ê°€ */
            border-radius: 5px;
            background-color: #f9f9f9; /* ë°°ê²½ìƒ‰ ì¶”ê°€ */
        }

        table {
            width: 100%;
            table-layout: fixed; /* í…Œì´ë¸” ë ˆì´ì•„ì›ƒì„ ê³ ì • */
            border-collapse: collapse; /* ì…€ ê²½ê³„ì„  ë³‘í•© */
        }

        th, td {
            width: 150px; /* ê° ì…€ì˜ ê³ ì • ë„ˆë¹„ ì„¤ì • */
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #ddd; /* í•˜ë‹¨ ê²½ê³„ì„  */
        }

        th {
            background-color: #f0f0f0; /* í—¤ë” ë°°ê²½ìƒ‰ */
            font-weight: bold; /* í—¤ë” í…ìŠ¤íŠ¸ êµµê²Œ */
        }

        tr:hover {
            background-color: #f5f5f5; /* ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ í–‰ì˜ ë°°ê²½ìƒ‰ ë³€ê²½ */
        }

        .table-container {
            max-height: 150px;
            overflow-y: auto;
        }
        h1{
            background-color: white;
            text-align: center;
        }
        .modal {
          display: none; /* ì²˜ìŒì—ëŠ” ë³´ì´ì§€ ì•ŠìŒ */
          position: fixed;
          z-index: 1;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          overflow: auto;
          background-color: rgba(0, 0, 0, 0.4);
          padding-top: 60px;
        }
        .modal_body {
          background-color: #fefefe;
          margin: 5% auto;
          padding: 20px;
          border: 1px solid #888;
          width: 400px; /* ì´ë¯¸ì§€ì˜ í¬ê¸°ì— ë§ê²Œ ì¡°ì • */
          display: flex;
          flex-direction: column;
          align-items: center; /* ì¤‘ì•™ ì •ë ¬ */
          position: relative; /* ìì‹ ìš”ì†Œì˜ ìœ„ì¹˜ ì¡°ì •ì„ ìœ„í•´ ì¶”ê°€ */
        }
        .btn-open-modal{
            cursor : pointer;
        }
        .image {
            max-width: 300px;
            max-height: 300px;
        }
        .modal_body p {
            text-align: center; /* nameê³¼ price ì¤‘ì•™ ì •ë ¬ */
            text-weight : bold;
        }

        .close_btn {
          position: absolute;
          top: 10px;
          right: 10px;
          background-color: red; /* ë°°ê²½ìƒ‰ ë¹¨ê°• */
          color: white; /* ê¸€ììƒ‰ í•˜ì–€ìƒ‰ */
          border: none;
          padding: 5px 10px;
          cursor: pointer;
          font-size: 16px;
          border-radius: 3px;
          z-index: 10; /* ë²„íŠ¼ì´ ë‹¤ë¥¸ ìš”ì†Œ ìœ„ì— í‘œì‹œë˜ë„ë¡ */
        }
        #sum{
            text-align: end;
            font-size: large;
            font-weight: bold;
            padding-right: 150px;
        }
        .search-box{
        height: 50px;
        width: 200px;
        background-color: white;
        border-radius: 40px;
        padding: 10px;
        border: 1px solid #f9deec;
        }
        .search-txt{
            border: none;
            background: none;
            outline: none;
            float: left;
            padding: 0px;
            color: #797979;
            font-size: 16px;
            line-height: 30px;
            width: 100px;
        }
        .search-btn{
            color: #f9deec;
            float: right;
            width: 40px;
            height: 100%;
            border-radius: 50%;
            background-color: white;
            border: none;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .search-btn:hover{
            cursor: pointer;
        }
        .search{
            width: 20%;
            height: 500px;
            padding: 10px;

        }
    </style>
</head>
<body>
<div style="width: 1280px; margin: auto">
    <div th:replace="~{.common/main.html :: menu}"></div>
    <div th:replace="~{.common/main.html :: kream}"></div>
    <div th:replace="~{.common/main.html :: nav}"></div>

    <div class="form-wrapper">
        <div class="search">
            <form class="search-box" action="/clothes/listall" method="get">
                <input name="name" class="search-txt" type="text" placeholder="ê²€ìƒ‰" th:value="${name}">
                <button class="search-btn" type="submit">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
            </form>
        </div>

        <div class="list">
            <h1>ALL</h1>

            <table>
                <thead>
                <tr>
                    <th>No</th>
                    <th>êµ¬ì…ì¼</th>
                    <th>ì¹´í…Œê³ ë¦¬</th>
                    <th>ì œí’ˆëª…</th>
                    <th>ê°€ê²©</th>
                    <th>êµ¬ë§¤ì²˜</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="clothes: ${clothesEntityList}">
                    <td th:text="${clothes.no}"></td>
                    <td th:text="${clothes.buydate}"></td>
                    <td th:text="${clothes.categoryName.categoryName}"></td>
                    <!-- ê° ë²„íŠ¼ì— data-id ì†ì„± ì¶”ê°€ -->
                    <td th:text="${clothes.name}" class="btn-open-modal" th:attr="data-id=${clothes.id}"></td>
                    <td th:text="${clothes.commaprice}"></td>
                    <td th:text="${clothes.purchaseplace}"></td>
                </tr>
                </tbody>
            </table>
        </div>
        <br>

    </div>
    <div id="sum">
        í•©ê³„ : <span th:text="${sum}"></span>ì› /
        ê°œìˆ˜ : <span th:text="${count}"></span>ê°œ
    </div>
</div>

<div class="modal">
    <div class="modal_body">
    </div>
</div>

<script>
  const modal = document.querySelector('.modal');
  const modalBody = document.querySelector('.modal_body');
  const btnOpenModals = document.querySelectorAll('.btn-open-modal'); // ëª¨ë“  ëª¨ë‹¬ ë²„íŠ¼ ì„ íƒ

  window.addEventListener('click', function(event) {
      if (event.target === modal) {
        modal.style.display = 'none';
      }
    });


  btnOpenModals.forEach((btnOpenModal) => {
    btnOpenModal.addEventListener("click", () => {
      // í´ë¦­ëœ ë²„íŠ¼ì˜ data-id ì†ì„± ê°’ ê°€ì ¸ì˜¤ê¸°
      const id = btnOpenModal.getAttribute('data-id');

      // í•´ë‹¹ idë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì²­ ì „ì†¡
      fetch(`/clothes/detail?id=${id}`)
        .then(response => response.json())
        .then(data => {
          const img = data.img;
          const name = data.name;
          const price = data.price;
          const id = data.id;
          const categorycode = data.categorycode;
          // ëª¨ë‹¬ ë‚´ìš© ì„¤ì •
           modalBody.innerHTML = `
              <button type="button" class="close_btn">X</button>
              <br>
              <img id="image" class="image" src="${img}" alt="Image Preview">
              <p>${name}</p>
              <p>${price}</p>
              <a href="/clothes/edit/${id}/${categorycode}">âœï¸</a>
                <span onclick="fetch('/clothes/delete/${id}', { method : 'DELETE' })
                .then(r => r.text())
                .then(() => {
                    location.reload();
                })
            ">ğŸ—‘ï¸</span>
            `;

          // ëª¨ë‹¬ ì°½ ë„ìš°ê¸°
          modal.style.display = "block";

          // ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ (ëª¨ë‹¬ ë‚´ìš©ì´ ë Œë”ë§ëœ í›„)
            const closeBtn = document.querySelector('.close_btn');
            closeBtn.addEventListener('click', function() {
              modal.style.display = 'none';
          });
        })
        .catch(error => {
          console.error("Error fetching financial data:", error);
          modalBody.innerHTML = "<p>ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>";
          modal.style.display = "block";
        });
    });
  });

  // ë§ˆìš°ìŠ¤ í˜¸ë²„ ì´ë²¤íŠ¸ ì²˜ë¦¬
  const containers = document.querySelectorAll('.container');
  containers.forEach(container => {
    const categoryBox = container.querySelector('.category-box');
    container.addEventListener('mouseenter', () => {
      categoryBox.classList.add('show'); // ITEMì´ë‚˜ CATEGORYì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ë¦¬ìŠ¤íŠ¸ ë³´ì´ê¸°
    });
    container.addEventListener('mouseleave', () => {
      categoryBox.classList.remove('show'); // ITEMê³¼ CATEGORY ëª¨ë‘ì—ì„œ ë§ˆìš°ìŠ¤ê°€ ë‚˜ê°€ë©´ ìˆ¨ê¸°ê¸°
    });
  });
</script>


</body>
</html>
